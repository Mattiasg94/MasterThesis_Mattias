import matplotlib.pyplot as plt
from scipy.optimize import curve_fit
import numpy as np
def func(x, a, b, c,d,e):
    return a*x**4+b*x**3+c*x**2+d*x+e



xdata=[19.36400947478089, 20.347665847640556, 21.331467989128658, 22.32653193823147, 23.326531880431777, 24.323113925392196, 25.297331248119352, 26.260409440450655, 27.23680436964355, 28.225532566197565, 29.219604155912563, 30.214952423756834, 31.209344205243838, 32.20197193329356, 33.193425565199135, 34.18471554993888]
ydata=[2.676092470273678, 2.8561484063951013, 3.0354061716478897, 3.1346419373572276, 3.1349819364495324, 3.0523730527716295, 2.8267614216478494, 2.5575395884770025, 2.341546666726318, 2.1918250806438553, 2.0830975564308156, 1.9867553242612892, 1.880996235237668, 1.759793126750913, 1.6293335706377918, 1.4976363187504471]

xdata=[18.367357997204685, 19.36400947478089, 20.347665847640556, 21.012263994612457, 21.315855474536406, 21.43641694014456, 21.43500095322823, 21.24246652896864, 20.819337417386848, 20.354069100625424, 20.179038227831427, 20.45756787035215, 21.13972809596188, 22.066240870874907, 23.044319197063224, 23.933853335497034]
ydata=[2.5943255316910845, 2.676092470273678, 2.8561484063951013, 3.121573297150484, 3.3664845398957617, 3.590742330473002, 3.8690993408068235, 4.148464197691252, 4.265192060025103, 3.9933552881400525, 3.3791889391431007, 2.6954215608112753, 2.2089630929139803, 2.0643050252663917, 2.2725423606331767, 2.7294110688643465]
xdata=np.array(xdata)
ydata=np.array(ydata)
# xdata = np.linspace(0, 4, 50)
# y = func(xdata, 2.5, 1.3, 0.5)
# np.random.seed(1729)
# y_noise = 0.2 * np.random.normal(size=xdata.size)
# ydata = y + y_noise


popt, pcov = curve_fit(func, xdata, ydata)


plt.plot(xdata, ydata, 'b-', label='data')
plt.plot(xdata, func(xdata, *popt), 'r-',
         label='fit: a=%5.3f, b=%5.3f, c=%5.3f,d=%5.3f,e=%5.3f' % tuple(popt))
plt.xlabel('x')
plt.ylabel('y')
plt.legend()
plt.show()